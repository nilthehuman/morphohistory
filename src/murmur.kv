#kivy 2.1

<TopBoxLayout>
    orientation: 'horizontal'
    size: root.width, root.height
    spacing: 0
    canvas:
        Color:
            rgb: 0, 0.08, 0.12
        Rectangle:
            pos: self.pos
            size: self.size
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'center'
        size_hint: 1, 1
        RelativeLayout:
            id: rel_layout
            size_hint: None, None
            size: 600, 600
            DemoAgoraWidget4:
                id: agora
                size_hint: 1, 1
    ButtonLayout:
        id: button_layout
        size_hint: None, 1
        width: 200

<ButtonLayout>
    orientation: 'tb-lr'
    cols: 1
    padding: [20, 50, 20, 100]
    spacing: 40
    canvas:
        Color:
            rgb: 0.05, 0.18, 0.22
        Rectangle:
            pos: self.pos
            size: self.size
    #AnchorLayout: # use this if centering stops working for some reason
    SaveToFileButton:
        id: save_to_file_button
        size_hint: None, None
        size: 160, 60
        text: 'Mentsd ezt el!'
    LoadFromFileButton:
        id: load_from_file_button
        size_hint: None, None
        size: 160, 60
        text: 'Tölts be egy agorát!'
    StartStopSimButton:
        size_hint: None, None
        size: 160, 60
    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1, None
        size: 160, 40
        RewindButton:
            id: rewind_button
            size_hint: 1, 1
            text: '<<'
            font_size: 32
        FastForwardButton:
            id: fast_forward_button
            size_hint: 1, 1
            text: '>>'
            font_size: 32
    Slider:
        id: speed_slider
        min: 0
        max: 100
        value: 80
        step: 1
        orientation: 'horizontal'
        size_hint: 1, None
        height: 30
        #background_width: 30 # set this when customizing appearance

<SaveToFilePopup>
    text_input: text_input
    canvas.before:
        Color:
            rgb: 0.05, 0, 0.2
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: '.'
            on_selection: text_input.text = self.selection and self.selection[0] or ''
        TextInput:
            id: text_input
            height: 30
            size_hint_y: None
            multiline: False
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 30
            Button:
                id: save_button
                text: "Mentsed"
                on_release: root.save(filechooser.path, text_input.text)
            Button:
                text: "Hagyjad"
                on_release: root.cancel()

<LoadFromFilePopup>
    canvas.before:
        Color:
            rgb: 0.05, 0, 0.2
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: '.'
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 30
            Button:
                id: save_button
                text: "Töltsd be"
                on_release: root.load(filechooser.path, filechooser.selection)
            Button:
                text: "Hagyjad"
                on_release: root.cancel()

<SaveToFileButton>
    text: self.text

<FastForwardPopup>
    canvas.before:
        Color:
            rgb: 0.03, 0.1, 0.2
        Rectangle:
            pos: self.pos
            size: self.size
    size: root.size
    pos: root.pos
    orientation: "vertical"
    ProgressBar:
        canvas:
            # code cribbed form stackoverflow.com/questions/51719374/how-to-change-color-of-progress-bar-kivy
            BorderImage:
                pos: self.x, self.center_y - 8
                size: self.width * (self.value / self.max) if self.max else 0, 16
                source: 'assets/progressbar.png'
        id: progressbar
        max: 10000
        pos_hint: {'center_x': 0.5}
        size_hint: 0.8, 0.8
    Label:
        orientation: "horizontal"
        text: str(progressbar.value)
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        size_hint: 1, 1
        Button:
            id: cancel_button
            text: "Mindegy, hagyjad!"
            pos_hint_x: 1
            size_hint: None, None
            size: 150, 50
            on_release: root.cancel()

<LoadFromFileButton>
    text: self.text

<StartStopSimButton>
    text: self.text

<SpeakerDot>
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 10000000
    drag_distance: 0
    size_hint: None, None  #size hints are kind of stupid
    canvas:
        Color:
            rgb: self.color
        Ellipse:
            size: self.width, self.height
            pos: self.pos

<BroadcasterSpeakerDot>
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 10000000
    drag_distance: 0
    size_hint: None, None  #size hints are kind of stupid
    canvas:
        Color:
            rgb: self.color
        PushMatrix
        Rotate:
            angle: 45
            axis: (0, 0, 1)
            origin: self.center
        Rectangle:
            size: [self.width, self.height]
            pos: self.pos
        PopMatrix

<NameTag>
    size: self.texture_size[0] + 5, self.texture_size[1] + 5
    size_hint: None, None
    canvas.before:
        Color:
            rgb: 0.2, 0.2, 0.2
        Rectangle:
            size: self.size
            pos: self.pos
